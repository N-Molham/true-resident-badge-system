!function(e,m){"use strict";jQuery(function(p){p.fn.repeatable_item=function(l){if("object"!=typeof doT)throw"Repeatable Exception: doT.js Template engine not found, click here https://github.com/olado/doT";l=p.extend({init:function(){},completed:function(){},new_item:function(){},removed:function(){}},l);var o={clean_template_holders:function(e){var t=e.replace(/\{[a-zA-Z0-9_\-]+\}/g,"");return t=(t=(t=(t=(t=(t=(t=t.replace(doT.templateSettings.evaluate,"")).replace(doT.templateSettings.interpolate,"")).replace(doT.templateSettings.encode,"")).replace(doT.templateSettings.use,"")).replace(doT.templateSettings.define,"")).replace(doT.templateSettings.conditional,"")).replace(doT.templateSettings.iterate,"")},add_item:function(e,t,a){var s;switch(a=a||!1,e.settings.is_empty&&(e.settings.is_empty=!1,e.find(".repeatable-empty").remove()),typeof a){case"boolean":s=e.item_template_dot(e.settings.defaultItem);break;case"object":s=e.item_template_dot(a);break;default:s=e.item_template.outerHTML().replace(new RegExp("{"+e.settings.valueKeyName+"}","g"),a)}s=s.replace(new RegExp("{"+e.settings.indexKeyName+"}","g"),t),s=o.clean_template_holders(s);var n=p(s).appendTo(e);e.settings.startIndex=parseInt(t)+1,e.trigger("repeatable-new-item",[e,n,t,a]),l.new_item(e,n,t,a)}};return this.each(function(e,t){var a=p(t);a.trigger("repeatable-init"),l.init(a),a.settings=p.extend({startIndex:0,templateSelector:"",indexKeyName:"index",valueKeyName:"value",addButtonLabel:"Add New",addButtonClass:"btn btn-primary",wrapperClass:"repeatable-wrapper",confirmRemoveMessage:"Are Your Sure ?",confirmRemove:"no",emptyListMessage:"<li>No Items Found</li>",defaultItem:{},values:[],valuesOrder:[],is_empty:!0},a.data()),a.wrap('<div class="'+a.settings.wrapperClass+'" />');var s=parseInt(a.settings.startIndex);if(""==a.settings.templateSelector)a.item_template=a.find("> [data-template=yes]").removeAttr("data-template").remove();else try{a.item_template=p(p(a.settings.templateSelector).html())}catch(e){throw"Repeatable Exception: Invalid item template selector <"+a.settings.templateSelector+">"}if(1!==a.item_template.size())throw"Repeatable Exception: Template item not found.";if(a.item_template_dot=doT.template(a.item_template.outerHTML()),a.item_template.remove_selector=a.item_template.prop("tagName").toLowerCase(),a.item_template.is("[class]")&&(a.item_template.remove_selector+='[class*="'+a.item_template.prop("className")+'"]'),a.add_new_btn=p('<p class="add-wrapper"><a href="#" class="'+a.settings.addButtonClass+'">'+a.settings.addButtonLabel+"</a></p>").insertAfter(a).on("click repeatable-add-click","a",function(e){e.preventDefault(),o.add_item(a,a.settings.startIndex)}),"object"==typeof a.settings.values){var n=[],i=p.isArray(a.settings.valuesOrder)&&a.settings.valuesOrder.length;if(p.each(i?a.settings.valuesOrder:a.settings.values,function(e,t){i&&a.settings.values!==m&&(e=t,t=a.settings.values[e]),t.order_index!==m&&(e=parseInt(t.order_index)),n.push(e),o.add_item(a,e,t),a.settings.is_empty=!1}),n.length){var r=Math.max.apply(Math,n);a.settings.startIndex=(s<r?r:s)+1}}a.settings.is_empty&&a.settings.emptyListMessage.length&&("item"===a.settings.emptyListMessage?a.add_new_btn.trigger("repeatable-add-click"):a.append(p(a.settings.emptyListMessage).addClass("repeatable-empty"))),a.on("click","[data-remove=yes]",function(e){if(e.preventDefault(),"yes"===a.settings.confirmRemove&&!confirm(a.settings.confirmRemoveMessage))return!1;var t=p(e.currentTarget).closest(a.item_template.remove_selector).remove();a.trigger("repeatable-removed",[a,t]),l.removed(a,t)}),a.trigger("repeatable-completed",[a]),l.completed(a)}),this},p.fn.outerHTML||(p.fn.outerHTML=function(){return p("<div />").append(this.eq(0).clone()).html()})})}(window);